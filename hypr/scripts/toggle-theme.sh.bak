#!/usr/bin/env bash

STATE_FILE="$HOME/.cache/theme_state"
LIGHT_WALL="$HOME/Pictures/wallpapers/light.png"
DARK_WALL="$HOME/Pictures/wallpapers/dark.png"

mkdir -p "$(dirname "$STATE_FILE")"

CURRENT=$(cat "$STATE_FILE" 2>/dev/null || echo "dark")

if [[ "$CURRENT" == "dark" ]]; then
  echo "light" > "$STATE_FILE"

  gsettings set org.gnome.desktop.interface color-scheme prefer-light
  gsettings set org.gnome.desktop.interface gtk-theme Adwaita

  awww img "$LIGHT_WALL" --transition-type wipe --transition-fps 90 --transition-step 5 --transition-angle 45 --transition-duration 2
else
  echo "dark" > "$STATE_FILE"

  gsettings set org.gnome.desktop.interface color-scheme prefer-dark
  gsettings set org.gnome.desktop.interface gtk-theme Adwaita-dark

  awww img "$DARK_WALL" --transition-type wipe --transition-fps 90 --transition-step 5 --transition-angle 225 --transition-duration 2

fi

